"use strict";var _createClass=function(){function e(e,s){for(var t=0;t<s.length;t++){var a=s[t];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}return function(s,t,a){if(t)e(s.prototype,t);if(a)e(s,a);return s}}();function _classCallCheck(e,s){if(!(e instanceof s)){throw new TypeError("Cannot call a class as a function")}}var EVENT_DATE_PICKER_YEAR_UPDATE="date-picker:year-update";var EVENT_DATE_PICKER_MONTH_UPDATE="date-picker:month-update";var EVENT_DATE_PICKER_FORCE_EDIT="date-picker:force-edit";var DatePicker=function(){function e(s){_classCallCheck(this,e);var t=new Date;var a=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1);this.defaults={value:a,minDate:a};this.cssSelectors={dp:".c-date-picker",dpFocused:".c-date-picker--focused",dpDisplay:".c-date-picker__display",dpDropDown:".c-date-picker__drop-down",dpYearWrapper:".c-date-picker__year-wrapper",dpMonthWrapper:".c-date-picker__month-wrapper",dpMonth:".c-date-picker__month",dpCalWrapper:".c-date-picker__cal-wrapper",dpWeekWrapper:".c-date-picker__week-wrapper",dpDate:".c-date-picker__date",dpOverlay:".c-date-picker__overlay",focus:".focus",active:".active",empty:".empty",disabled:".disabled",jsPrevYear:".js-date-picker-prev-year",jsYear:".js-date-picker-year",jsNextYear:".js-date-picker-next-year"};this.$input=s;this.setup();this.bindUIActions()}_createClass(e,[{key:"setup",value:function e(){var s=getClassNameFromSelector(this.cssSelectors.dp);var t=getClassNameFromSelector(this.cssSelectors.dpDisplay);var a=getClassNameFromSelector(this.cssSelectors.dpDropDown);if(this.$input.val()){this.defaults.value=new Date(this.$input.val())}this.$dp=$('<div class="'+s+'"></div>');this.$dp.insertAfter(this.$input);this.$dpDisplay=$('<input type="text" class="'+t+'" readonly>');this.$dpDisplay.val(getFormattedDate(this.defaults.value));this.$dp.append(this.$dpDisplay);var r=$('<div class="'+a+'"></div>');this.$dp.append(r);this.$dpYearWrapper=$(this._getYearWrapperHtml());r.append(this.$dpYearWrapper);this.$dpMonthWrapper=$(this._getMonthWrapperHtml());r.append(this.$dpMonthWrapper);this.$dpCalWrapper=$(this._getCalWrapperHtml());r.append(this.$dpCalWrapper);this.$input.attr("type","hidden");this.$dp.append(this.$input);this.$dpOverlay=$(this._getOverlayHtml());this.$dp.append(this.$dpOverlay)}},{key:"bindUIActions",value:function e(){this.$dp.on("focus",this.show.bind(this));this.$dpDisplay.on("focus",this.show.bind(this));this.$dpOverlay.on("click",this.hide.bind(this));this.$dp.on("click",this.cssSelectors.jsPrevYear,function(){"use strict";this.$year.val(parseInt(this.$year.val())-1);this.$dp.trigger(EVENT_DATE_PICKER_YEAR_UPDATE)}.bind(this));this.$dp.on("click",this.cssSelectors.jsNextYear,function(){"use strict";this.$year.val(parseInt(this.$year.val())+1);this.$dp.trigger(EVENT_DATE_PICKER_YEAR_UPDATE)}.bind(this));this.$year.on("change",this.updateMonth.bind(this));this.$dp.on(EVENT_DATE_PICKER_YEAR_UPDATE,this.updateMonth.bind(this));this.$dp.on(EVENT_DATE_PICKER_MONTH_UPDATE,this.updateCal.bind(this));this.$dp.on("keyup",this.cssSelectors.dpMonthWrapper,this._navigateMonthsWithKeys.bind(this));this.$dp.on("click",this.cssSelectors.dpMonth,this.selectMonth.bind(this));this.$dp.on("keyup",this.cssSelectors.dpCalWrapper,this._navigateDateWithKeys.bind(this));this.$dp.on("click",this.cssSelectors.dpDate,this.selectDate.bind(this));this.$dp.on(EVENT_DATE_PICKER_FORCE_EDIT,this.forceEditHandler.bind(this))}},{key:"show",value:function e(){this.reset();this.$dp.addClass(getClassNameFromSelector(this.cssSelectors.dpFocused))}},{key:"hide",value:function e(){this.$dp.removeClass(getClassNameFromSelector(this.cssSelectors.dpFocused))}},{key:"forceEditHandler",value:function e(){this.show();this.$dp.focus()}},{key:"reset",value:function e(){this.$year.val(this.defaults.value.getFullYear());this.$dpMonthWrapper.remove();this.$dpMonthWrapper=$(this._getMonthWrapperHtml());this.$dpMonthWrapper.insertAfter(this.$dpYearWrapper);this.$dpCalWrapper.remove();this.$dpCalWrapper=$(this._getCalWrapperHtml());this.$dpCalWrapper.insertAfter(this.$dpMonthWrapper)}},{key:"updateMonth",value:function e(){var s=this.$dpMonthWrapper;this.$dpMonthWrapper=$(this._getMonthWrapperHtml());s.replaceWith(this.$dpMonthWrapper);this.$dp.trigger(EVENT_DATE_PICKER_MONTH_UPDATE)}},{key:"updateCal",value:function e(){this.$dpCalWrapper.remove();this.$dpCalWrapper=$(this._getCalWrapperHtml());this.$dpCalWrapper.insertAfter(this.$dpMonthWrapper)}},{key:"_navigateMonthsWithKeys",value:function e(s){var t=37;var a=38;var r=39;var i=40;var l=13;var c=getClassNameFromSelector(this.cssSelectors.focus);var h=getClassNameFromSelector(this.cssSelectors.disabled);var n=$(this.cssSelectors.dpMonth+this.cssSelectors.focus);if(!n.length){n=$(this.cssSelectors.dpMonth+":not("+this.cssSelectors.disabled+")").first();n.addClass(c)}var o;switch(s.keyCode){case t:o=n.prev();if(!o.length){o=n.siblings(":last")}if(o.hasClass(h)){o=n.siblings(":not("+this.cssSelectors.disabled+")").last()}o.addClass(c).siblings().removeClass(c);break;case r:o=n.next();if(!o.length){o=n.siblings(":first")}if(o.hasClass(h)){o=n.siblings(":not("+this.cssSelectors.disabled+")").first()}o.addClass(c).siblings().removeClass(c);break;case a:case i:var p=$(this.cssSelectors.dpMonth);var d=p.index(n);if(d<6){o=p.eq(d+6)}else{o=p.eq(d-6)}if(!o.hasClass(h)){o.addClass(c).siblings().removeClass(c)}break;case l:n.click()}}},{key:"_navigateDateWithKeys",value:function e(s){var t=37;var a=38;var r=39;var i=40;var l=13;var c=$(this.cssSelectors.dpDate).filter(":not("+this.cssSelectors.empty+")");var h=getClassNameFromSelector(this.cssSelectors.focus);var n=getClassNameFromSelector(this.cssSelectors.disabled);var o=c.filter(this.cssSelectors.focus);if(!o.length){o=c.filter(":not("+this.cssSelectors.disabled+")").first();o.addClass(h)}var p=c.index(o);var d;switch(s.keyCode){case t:if(p===0){d=c.filter(":not("+this.cssSelectors.disabled+")").last()}else{d=c.eq(p-1)}if(d.hasClass(n)){d=c.filter(":not("+this.cssSelectors.disabled+")").last()}d.addClass(h).siblings().removeClass(h);break;case r:if(p===c.length-1){d=c.filter(":not("+this.cssSelectors.disabled+")").first()}else{d=c.eq(p+1)}if(d.hasClass(n)){d=c.filter(":not("+this.cssSelectors.disabled+")").first()}d.addClass(h).siblings().removeClass(h);break;case a:if(p<=6){return}d=c.eq(p-7);if(!d.length){return}if(d.hasClass(n)){return}d.addClass(h).siblings().removeClass(h);break;case i:if(p>=c.length-7){return}d=c.eq(p+7);if(!d.length){return}if(d.hasClass(n)){return}d.addClass(h).siblings().removeClass(h);break;case l:o.click();break}}},{key:"selectMonth",value:function e(s){var t=$(s.currentTarget);var a=getClassNameFromSelector(this.cssSelectors.disabled);if(t.hasClass(a)){return}var r=getClassNameFromSelector(this.cssSelectors.active);t.siblings("li").removeClass(r);t.addClass(r);this.$dp.trigger(EVENT_DATE_PICKER_MONTH_UPDATE)}},{key:"selectDate",value:function e(s){var t=$(s.currentTarget);var a=getClassNameFromSelector(this.cssSelectors.active);t.siblings("li").removeClass(a);t.addClass(a);var r=this.$year.val();var i=this._getSelectedMonth();var l=parseInt(t.text());this.defaults.value=new Date(r,i,l);this.$dpDisplay.val(getFormattedDate(this.defaults.value));this.$input.val(getFormattedDate(this.defaults.value));this.hide()}},{key:"_getYearWrapperHtml",value:function e(){var s=getClassNameFromSelector(this.cssSelectors.dpYearWrapper);var t=getClassNameFromSelector(this.cssSelectors.jsPrevYear);var a=getClassNameFromSelector(this.cssSelectors.jsYear);var r=getClassNameFromSelector(this.cssSelectors.jsNextYear);return['<div class="'+s+'">','<span class="'+t+' fa fa-caret-left"></span>','<input type="text" class="'+a+'" value="'+this.defaults.value.getFullYear()+'">','<span class="'+r+' fa fa-caret-right"></span>',"</div>"].join("")}},{key:"_getMonthWrapperHtml",value:function e(){if(!this.$year){this.$year=$(this.cssSelectors.jsYear)}var s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var t=new Date(this.$year.val(),0,1);var a=t.getFullYear()===this.defaults.value.getFullYear();var r=this.defaults.value.getMonth();var i=0;if(this.defaults.minDate){if(t.getFullYear()<this.defaults.minDate.getFullYear()){i=12}else if(t.getFullYear()===this.defaults.minDate.getFullYear()){i=this.defaults.minDate.getMonth()}}var l=getClassNameFromSelector(this.cssSelectors.dpMonthWrapper);var c=getClassNameFromSelector(this.cssSelectors.dpMonth);var h=getClassNameFromSelector(this.cssSelectors.disabled);var n=getClassNameFromSelector(this.cssSelectors.active);var o=['<ul class="'+l+'" tabindex="0">'];for(var p=0;p<12;p++){var d=[c];if(p<i){d.push(h)}else if(a&&p===r){d.push(n)}var u=["<li",'data-month="'+p+'"','class="'+d.join(" ")+'"'];u.push(">"+s[p]+"</li>");o.push(u.join(" "))}o.push("</ul>");return o.join("")}},{key:"_getCalWrapperHtml",value:function e(){var s=getClassNameFromSelector(this.cssSelectors.dpCalWrapper);var t=getClassNameFromSelector(this.cssSelectors.dpWeekWrapper);var a=getClassNameFromSelector(this.cssSelectors.dpDate);var r=getClassNameFromSelector(this.cssSelectors.disabled);var i=getClassNameFromSelector(this.cssSelectors.active);var l=getClassNameFromSelector(this.cssSelectors.empty);var c=['<div class="'+s+'" tabindex="0">'];var h=["S","M","T","W","T","F","S"];c.push('<ul class="'+t+'">');for(var n=0;n<7;n++){c.push('<li class="'+[a,l].join(" ")+'">'+h[n]+"</li>")}c.push("</ul>");c.push('<ul class="'+t+'">');var o=this.$year.val();var p=this._getSelectedMonth();if(p===-1){return}var d=new Date(o,p,1);var u=1;var v=d.getFullYear()===this.defaults.value.getFullYear();var f=d.getMonth()===this.defaults.value.getMonth();var g=this.defaults.value.getDate();if(this.defaults.minDate){if(d.getFullYear()<this.defaults.minDate.getFullYear()){u=32}else if(d.getFullYear()===this.defaults.minDate.getFullYear()){if(d.getMonth()<this.defaults.minDate.getMonth()){u=32}else if(d.getMonth()===this.defaults.minDate.getMonth()){u=this.defaults.minDate.getDate()}}}for(var m=0;m<d.getDay();m++){c.push('<li class="'+[a,l].join(" ")+'">&nbsp;</li>')}var C=getDaysInMonth(o,p);for(var $=1;$<=C;$++){var S=[a];if($<u){S.push(r)}else if(v&&f&&$===g){S.push(i)}c.push('<li class="'+S.join(" ")+'">'+$+"</li>")}c.push("</ul>");c.push("</div>");return c.join("")}},{key:"_getSelectedMonth",value:function e(){var s=$(this.cssSelectors.dpMonth+this.cssSelectors.active);var t=$(this.cssSelectors.dpMonth);return t.index(s)}},{key:"_getOverlayHtml",value:function e(){var s=getClassNameFromSelector(this.cssSelectors.dpOverlay);return'<div class="'+s+'"></div>'}}]);return e}();function getFormattedDate(e){"use strict";return[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-")}function getDaysInMonth(e,s){return new Date(e,s+1,0).getDate()}function getClassNameFromSelector(e){"use strict";return e.replace(".","")}$.fn.zyreDatePicker=function(){"use strict";$(this).each(function(){var e=$(this);var s=new DatePicker(e)})};