"use strict";var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}return function(t,s,a){if(s)e(t.prototype,s);if(a)e(t,a);return t}}();function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var EVENT_DATE_PICKER_YEAR_UPDATE="date-picker:year-update";var EVENT_DATE_PICKER_MONTH_UPDATE="date-picker:month-update";var EVENT_DATE_PICKER_FORCE_EDIT="date-picker:force-edit";var EVENT_DATE_PICKER_ENTER="date-picker:enter";var EVENT_DATE_PICKER_EXIT="date-picker:exit";var DatePicker=function(){_createClass(e,null,[{key:"FORMAT_DATE",get:function e(){return"date"}},{key:"FORMAT_DATETIME",get:function e(){return"datetime"}}]);function e(t){_classCallCheck(this,e);this.defaults={};this.cssSelectors={dp:".c-date-picker",dpFocused:".c-date-picker--focused",dpDisplay:".c-date-picker__display",dpDropDown:".c-date-picker__drop-down",dpYearWrapper:".c-date-picker__year-wrapper",dpMonthWrapper:".c-date-picker__month-wrapper",dpMonth:".c-date-picker__month",dpCalWrapper:".c-date-picker__cal-wrapper",dpWeekWrapper:".c-date-picker__week-wrapper",dpDate:".c-date-picker__date",dpTimeWrapper:".c-date-picker__time-wrapper",dpSelectMenuLabel:".c-date-picker__select-label",dpSelectMenu:".c-date-picker__select",dpOverlay:".c-date-picker__overlay",focus:".focus",active:".active",empty:".empty",disabled:".disabled",jsPrevYear:".js-date-picker-prev-year",jsYear:".js-date-picker-year",jsNextYear:".js-date-picker-next-year",jsHour:".js-date-picker-hour",jsMinute:".js-date-picker-minute",jsMeridian:".js-date-picker-meridian"};this.$input=t;this.parseInputAttrs();this.setup();this.bindUIActions()}_createClass(e,[{key:"parseInputAttrs",value:function t(){var s=this.$input.data("min-date");var a=o(s);if(!isNaN(a)){this.defaults.minDate=a}var r=this.$input.val();var i=o(r);if(isNaN(i)){this.defaults.value=o("today")}else{this.defaults.value=i}var l=this.$input.data("format");if(!l){l=e.FORMAT_DATE}var n=[e.FORMAT_DATE,e.FORMAT_DATETIME];if(n.indexOf(l)!==-1){this.defaults.format=l}function o(e){var t=new Date;var s=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1);switch(e){case"today":return t;case"tomorrow":return s;default:return new Date(e)}}}},{key:"setup",value:function t(){var s=getClassNameFromSelector(this.cssSelectors.dp);var a=getClassNameFromSelector(this.cssSelectors.dpDisplay);var r=getClassNameFromSelector(this.cssSelectors.dpDropDown);this.$dp=$('<div class="'+s+'"></div>');this.$dp.insertAfter(this.$input);this.$dpDisplay=$('<input type="text" class="'+a+'" readonly>');var i=getFormattedDate(this.defaults.value);if(this.defaults.format===e.FORMAT_DATETIME){i=getFormattedDateTime(this.defaults.value,true)}this.$dpDisplay.val(i);this.$dp.append(this.$dpDisplay);var l=$('<div class="'+r+'"></div>');this.$dp.append(l);this.$dpYearWrapper=$(this.getYearWrapperHtml());l.append(this.$dpYearWrapper);this.$dpMonthWrapper=$(this.getMonthWrapperHtml());l.append(this.$dpMonthWrapper);this.$dpCalWrapper=$(this.getCalWrapperHtml());l.append(this.$dpCalWrapper);if(this.defaults.format===e.FORMAT_DATETIME){this.$dpTimeWrapper=$(this.getTimeWrapperHtml());l.append(this.$dpTimeWrapper)}this.$input.attr("type","hidden");this.$dp.append(this.$input);this.$dpOverlay=$(this.getOverlayHtml());this.$dp.append(this.$dpOverlay);this.$year=this.$dp.find(this.cssSelectors.jsYear);this.$hour=this.$dp.find(this.cssSelectors.jsHour);this.$minute=this.$dp.find(this.cssSelectors.jsMinute);this.$meridian=this.$dp.find(this.cssSelectors.jsMeridian)}},{key:"bindUIActions",value:function e(){this.$dp.on("focus",this.show.bind(this));this.$dpDisplay.on("focus",this.show.bind(this));this.$dpOverlay.on("click",this.hide.bind(this));this.$dp.on("click",this.cssSelectors.jsPrevYear,function(){"use strict";this.$year.val(parseInt(this.$year.val())-1);this.$dp.trigger(EVENT_DATE_PICKER_YEAR_UPDATE)}.bind(this));this.$dp.on("click",this.cssSelectors.jsNextYear,function(){"use strict";this.$year.val(parseInt(this.$year.val())+1);this.$dp.trigger(EVENT_DATE_PICKER_YEAR_UPDATE)}.bind(this));this.$year.on("change",function(e){this.updateMonth()}.bind(this));var t=getClassNameFromSelector(this.cssSelectors.disabled);this.$year.on("keyup",function(e){if(e.keyCode!==13){this.$dpMonthWrapper.addClass(t);this.$dpCalWrapper.addClass(t);return}this.$dpMonthWrapper.removeClass(t);this.$dpCalWrapper.removeClass(t);this.$dpMonthWrapper.focus();this.navigateMonthsWithKeys()}.bind(this));this.$year.on("blur",function(e){this.$dpMonthWrapper.focus()}.bind(this));this.$dp.on(EVENT_DATE_PICKER_YEAR_UPDATE,this.updateMonth.bind(this));this.$dp.on(EVENT_DATE_PICKER_MONTH_UPDATE,this.updateCal.bind(this));this.$dp.on("keyup",this.cssSelectors.dpMonthWrapper,this.navigateMonthsWithKeys.bind(this));this.$dp.on("click",this.cssSelectors.dpMonth,this.selectMonth.bind(this));this.$dp.on("keyup",this.cssSelectors.dpCalWrapper,this.navigateDateWithKeys.bind(this));this.$dp.on("click",this.cssSelectors.dpDate,this.selectDate.bind(this));this.$dp.on(EVENT_DATE_PICKER_FORCE_EDIT,this.forceEditHandler.bind(this));this.$dp.on("click",this.cssSelectors.dpTimeWrapper+" button",this.setTimeAndHide.bind(this));$("body").on(EVENT_DATE_PICKER_ENTER,function(e){if(e.target!==this.$dp.get(0)){this.$dp.removeAttr("tabindex");this.$dpDisplay.attr("disabled",true)}}.bind(this));$("body").on(EVENT_DATE_PICKER_EXIT,function(e){if(e.target!==this.$dp.get(0)){this.$dp.attr("tabindex","0");this.$dpDisplay.removeAttr("disabled")}}.bind(this))}},{key:"show",value:function e(){this.reset();this.$dp.addClass(getClassNameFromSelector(this.cssSelectors.dpFocused));$("html,body").css({overflow:"hidden"});this.$dp.trigger(EVENT_DATE_PICKER_ENTER)}},{key:"hide",value:function e(){this.$dp.removeClass(getClassNameFromSelector(this.cssSelectors.dpFocused));$("html,body").css({overflow:"auto"});this.$dp.trigger(EVENT_DATE_PICKER_EXIT);this.$dp.blur()}},{key:"forceEditHandler",value:function e(){this.show();this.$dp.focus()}},{key:"reset",value:function e(){this.$year.val(this.defaults.value.getFullYear());this.$dpMonthWrapper.remove();this.$dpMonthWrapper=$(this.getMonthWrapperHtml());this.$dpMonthWrapper.insertAfter(this.$dpYearWrapper);this.$dpCalWrapper.remove();this.$dpCalWrapper=$(this.getCalWrapperHtml());this.$dpCalWrapper.insertAfter(this.$dpMonthWrapper)}},{key:"updateMonth",value:function e(){var t=this.$dpMonthWrapper;this.$dpMonthWrapper=$(this.getMonthWrapperHtml());t.replaceWith(this.$dpMonthWrapper);this.$dp.trigger(EVENT_DATE_PICKER_MONTH_UPDATE)}},{key:"updateCal",value:function e(){this.$dpCalWrapper.remove();this.$dpCalWrapper=$(this.getCalWrapperHtml());this.$dpCalWrapper.insertAfter(this.$dpMonthWrapper)}},{key:"navigateMonthsWithKeys",value:function e(t){var s=37;var a=38;var r=39;var i=40;var l=13;var n=getClassNameFromSelector(this.cssSelectors.focus);var o=getClassNameFromSelector(this.cssSelectors.disabled);if(this.$dpMonthWrapper.hasClass(o)){return}var c=this.$dp.find(this.cssSelectors.dpMonth+this.cssSelectors.focus);if(!c.length){c=this.$dp.find(this.cssSelectors.dpMonth+this.cssSelectors.active);c.addClass(n)}if(!c.length){c=this.$dp.find(this.cssSelectors.dpMonth+":not("+this.cssSelectors.disabled+")").first();c.addClass(n)}if(!t){return}var h;switch(t.keyCode){case s:h=c.prev();if(!h.length){h=c.siblings(":last")}if(h.hasClass(o)){h=c.siblings(":not("+this.cssSelectors.disabled+")").last()}h.addClass(n).siblings().removeClass(n);break;case r:h=c.next();if(!h.length){h=c.siblings(":first")}if(h.hasClass(o)){h=c.siblings(":not("+this.cssSelectors.disabled+")").first()}h.addClass(n).siblings().removeClass(n);break;case a:case i:var p=this.$dp.find(this.cssSelectors.dpMonth);var d=p.index(c);if(d<6){h=p.eq(d+6)}else{h=p.eq(d-6)}if(!h.hasClass(o)){h.addClass(n).siblings().removeClass(n)}break;case l:c.click();this.$dpCalWrapper.focus();this.navigateDateWithKeys()}}},{key:"navigateDateWithKeys",value:function e(t){var s=37;var a=38;var r=39;var i=40;var l=13;var n=this.$dp.find(this.cssSelectors.dpDate).filter(":not("+this.cssSelectors.empty+")");var o=getClassNameFromSelector(this.cssSelectors.focus);var c=getClassNameFromSelector(this.cssSelectors.disabled);if(this.$dpCalWrapper.hasClass(c)){return}var h=n.filter(this.cssSelectors.focus);if(!h.length){h=n.filter(":not("+this.cssSelectors.disabled+")").first();h.addClass(o)}if(!t){return}var p=n.index(h);var d;switch(t.keyCode){case s:if(p===0){d=n.filter(":not("+this.cssSelectors.disabled+")").last()}else{d=n.eq(p-1)}if(d.hasClass(c)){d=n.filter(":not("+this.cssSelectors.disabled+")").last()}d.addClass(o).siblings().removeClass(o);break;case r:if(p===n.length-1){d=n.filter(":not("+this.cssSelectors.disabled+")").first()}else{d=n.eq(p+1)}if(d.hasClass(c)){d=n.filter(":not("+this.cssSelectors.disabled+")").first()}d.addClass(o).siblings().removeClass(o);break;case a:if(p<=6){return}d=n.eq(p-7);if(!d.length){return}if(d.hasClass(c)){return}d.addClass(o).siblings().removeClass(o);break;case i:if(p>=n.length-7){return}d=n.eq(p+7);if(!d.length){return}if(d.hasClass(c)){return}d.addClass(o).siblings().removeClass(o);break;case l:h.click();break}}},{key:"selectMonth",value:function e(t){var s=$(t.currentTarget);var a=getClassNameFromSelector(this.cssSelectors.disabled);if(s.hasClass(a)){return}var r=getClassNameFromSelector(this.cssSelectors.active);s.siblings("li").removeClass(r);s.addClass(r);this.$dp.trigger(EVENT_DATE_PICKER_MONTH_UPDATE)}},{key:"selectDate",value:function t(s){var a=$(s.currentTarget);var r=getClassNameFromSelector(this.cssSelectors.active);a.siblings("li").removeClass(r);a.addClass(r);var i=this.$year.val();var l=this.getSelectedMonth();var n=parseInt(a.text());this.defaults.value=new Date(i,l,n);this.$dpDisplay.val(getFormattedDate(this.defaults.value));this.$input.val(getFormattedDate(this.defaults.value));var o=getClassNameFromSelector(this.cssSelectors.focus);$(this.cssSelectors.dpDate).removeClass(o);if(this.defaults.format===e.FORMAT_DATE){this.hide()}else if(this.defaults.format===e.FORMAT_DATETIME){this.$hour.focus()}}},{key:"setTimeAndHide",value:function e(){var t=this.$year.val();var s=this.getSelectedMonth();var a=this.getSelectedDate();var r=parseInt(this.$hour.val());var i=parseInt(this.$minute.val());var l=this.$meridian.val();if(r===""){this.$hour.focus()}else if(i===""){this.$minute.focus()}else if(l===""){this.$meridian.focus()}else{if(l==="pm"){r+=12}var n=new Date(t,s,a,r,i);if(isNaN(n)){console.log("Invalid date: year:"+t+" month:"+s+" date:"+a+" hour:"+r+" minute:"+i);return}this.$dpDisplay.val(getFormattedDateTime(n,true));this.$input.val(getFormattedDateTime(n));this.defaults.value=n;this.hide()}}},{key:"getYearWrapperHtml",value:function e(){var t=getClassNameFromSelector(this.cssSelectors.dpYearWrapper);var s=getClassNameFromSelector(this.cssSelectors.jsPrevYear);var a=getClassNameFromSelector(this.cssSelectors.jsYear);var r=getClassNameFromSelector(this.cssSelectors.jsNextYear);return['<div class="'+t+'">','<span class="'+s+' fa fa-caret-left"></span>','<input type="text" class="'+a+'" value="'+this.defaults.value.getFullYear()+'">','<span class="'+r+' fa fa-caret-right"></span>',"</div>"].join("")}},{key:"getMonthWrapperHtml",value:function e(){if(!this.$year){this.$year=this.$dp.find(this.cssSelectors.jsYear)}var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var s=new Date(this.$year.val(),0,1);var a=s.getFullYear()===this.defaults.value.getFullYear();var r=this.defaults.value.getMonth();var i=0;if(this.defaults.minDate){if(s.getFullYear()<this.defaults.minDate.getFullYear()){i=12}else if(s.getFullYear()===this.defaults.minDate.getFullYear()){i=this.defaults.minDate.getMonth()}}var l=getClassNameFromSelector(this.cssSelectors.dpMonthWrapper);var n=getClassNameFromSelector(this.cssSelectors.dpMonth);var o=getClassNameFromSelector(this.cssSelectors.disabled);var c=getClassNameFromSelector(this.cssSelectors.active);var h=['<ul class="'+l+'" tabindex="0">'];for(var p=0;p<12;p++){var d=[n];if(p<i){d.push(o)}else if(a&&p===r){d.push(c)}var u=["<li",'data-month="'+p+'"','class="'+d.join(" ")+'"'];u.push(">"+t[p]+"</li>");h.push(u.join(" "))}h.push("</ul>");return h.join("")}},{key:"getCalWrapperHtml",value:function e(){var t=getClassNameFromSelector(this.cssSelectors.dpCalWrapper);var s=getClassNameFromSelector(this.cssSelectors.dpWeekWrapper);var a=getClassNameFromSelector(this.cssSelectors.dpDate);var r=getClassNameFromSelector(this.cssSelectors.disabled);var i=getClassNameFromSelector(this.cssSelectors.active);var l=getClassNameFromSelector(this.cssSelectors.empty);var n=['<div class="'+t+'" tabindex="0">'];var o=["S","M","T","W","T","F","S"];n.push('<ul class="'+s+'">');for(var c=0;c<7;c++){n.push('<li class="'+[a,l].join(" ")+'">'+o[c]+"</li>")}n.push("</ul>");n.push('<ul class="'+s+'">');var h=this.$year.val();var p=this.getSelectedMonth();if(p===-1){return}var d=new Date(h,p,1);var u=1;var v=d.getFullYear()===this.defaults.value.getFullYear();var f=d.getMonth()===this.defaults.value.getMonth();var m=this.defaults.value.getDate();if(this.defaults.minDate){if(d.getFullYear()<this.defaults.minDate.getFullYear()){u=32}else if(d.getFullYear()===this.defaults.minDate.getFullYear()){if(d.getMonth()<this.defaults.minDate.getMonth()){u=32}else if(d.getMonth()===this.defaults.minDate.getMonth()){u=this.defaults.minDate.getDate()}}}for(var g=0;g<d.getDay();g++){n.push('<li class="'+[a,l].join(" ")+'">&nbsp;</li>')}var $=getDaysInMonth(h,p);for(var C=1;C<=$;C++){var S=[a];if(C<u){S.push(r)}else if(v&&f&&C===m){S.push(i)}n.push('<li class="'+S.join(" ")+'">'+C+"</li>")}n.push("</ul>");n.push("</div>");return n.join("")}},{key:"getTimeWrapperHtml",value:function e(){var t=getClassNameFromSelector(this.cssSelectors.dpTimeWrapper);var s=getClassNameFromSelector(this.cssSelectors.dpSelectMenuLabel);var a=getClassNameFromSelector(this.cssSelectors.dpSelectMenu);var r=getClassNameFromSelector(this.cssSelectors.jsHour);var i=getClassNameFromSelector(this.cssSelectors.jsMinute);var l=getClassNameFromSelector(this.cssSelectors.jsMeridian);var n="";var o=this.defaults.value.getHours();var c=this.defaults.value.getMinutes();var h='<label class="'+s+'">\n    <select class="'+a+" "+r+'">\n        <option value="">hh</option>';for(var p=0;p<=12;p++){n="";if(o===p||o%12===p){n=" selected "}p=("0"+p).slice(-2);h+='<option value="'+p+'" '+n+">"+p+"</option>"}h+="</select></label>";var d=[0,15,30,45];var u='<label class="'+s+'">\n    <select class="'+a+" "+i+'">\n      <option value="">mm</option>';for(var v in d){n="";var f=parseInt(v)+1;if(c>=d[v]&&c<d[f]){n=" selected "}var m=("0"+d[v]).slice(-2);u+='<option value="'+m+'" '+n+">"+m+"</option>"}u+="</select></label>";var g="";var $="";if(o<12){g=" selected "}else{$=" selected "}var C='<label class="'+s+'">\n    <select class="'+a+" "+l+'">\n      <option value="">----</option>\n      <option value="am" '+g+'>am</option>\n      <option value="pm" '+$+">pm</option>\n    </select></label>";return'<div class="'+t+'">\n      <div>\n        '+h+"&nbsp;"+u+"&nbsp;"+C+'\n        <button type="button">Go</button>\n      </div>\n    </div>'}},{key:"getSelectedMonth",value:function e(){var t=this.$dp.find(this.cssSelectors.dpMonth+this.cssSelectors.active);var s=this.$dp.find(this.cssSelectors.dpMonth);return s.index(t)}},{key:"getSelectedDate",value:function e(){var t=this.$dp.find(this.cssSelectors.dpDate+this.cssSelectors.active);return parseInt(t.text())}},{key:"getOverlayHtml",value:function e(){var t=getClassNameFromSelector(this.cssSelectors.dpOverlay);return'<div class="'+t+'"></div>'}}]);return e}();function getFormattedDate(e){"use strict";return[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-")}function getFormattedDateTime(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var s=[("0"+e.getHours()).slice(-2),("0"+e.getMinutes()).slice(-2),("0"+e.getSeconds()).slice(-2)].join(":");if(t){var a=e.getHours();if(a>12){a=a%12}var r="am";if(e.getHours()>=12){r="pm"}s=[("0"+a).slice(-2),("0"+e.getMinutes()).slice(-2)].join(":");s=s+" "+r}return getFormattedDate(e)+" "+s}function getDaysInMonth(e,t){return new Date(e,t+1,0).getDate()}function getClassNameFromSelector(e){"use strict";return e.replace(".","")}$.fn.datepicker=function(){"use strict";$(this).each(function(){var e=$(this);var t=new DatePicker(e)})};